<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" type="text/css" href="../top&footer_css/top&fotter_style.css">
    <link rel="stylesheet" type="text/css" href="../top&footer_css/ionicons.min.css">
    <title>
        城市建築物名冊丨Buddy-INFO Buddy市指南
    </title>
    <link rel="icon" href="../image/spawn.png">
    <!--メインビジュアルのスライド-->
</head>

<body>
    <a href="#" id="toTop" style="display: none;">
        <span id="toTopHover"></span>To Top</a>
    <!--Page Body Start-->
    <!-- Phone Top -->
    <div class="PaddingTop">　</div>
    <div class="PhoneTop">
        <div class="PhoneTop__mainnav">
            <div class="PhoneTop__mainnav__icon" onclick="menu_burger(this)">
                <div class="bar1"></div>
                <div class="bar2"></div>
                <div class="bar3"></div>
            </div>
        </div>
        <div class="PhoneTop__logo">
            <img class="PhoneTop__logo__image" src="../image/logo.png">
        </div>
        <div class="PhoneTop__mainnav__container" id="PhoneTop__mainnav__container">
            <div class="PhoneTop__mainnav__container__col">
                <a class="PhoneTop__mainnav__container__col__a" href="../#">
                    <div class="PhoneTop__mainnav__container__col__a__eng">HOME</div>
                    <div class="PhoneTop__mainnav__container__col__a__chi">回到首頁</div>
                </a>
                <a class="PhoneTop__mainnav__container__col__a" href="https://buddycityinfo.sgngs.com/map.html"
                    target="_blank">
                    <div class="PhoneTop__mainnav__container__col__a__eng">ONLINE MAP</div>
                    <div class="PhoneTop__mainnav__container__col__a__chi">打開網上地圖</div>
                </a>
                <a class="PhoneTop__mainnav__container__col__a" href="#">
                    <div class="PhoneTop__mainnav__container__col__a__eng">CITY BUILDING LIST</div>
                    <div class="PhoneTop__mainnav__container__col__a__chi">查看城市建築物名冊</div>
                </a>
                <a class="PhoneTop__mainnav__container__col__a" href="../resident/">
                    <div class="PhoneTop__mainnav__container__col__a__eng">CITY RESIDENT LIST</div>
                    <div class="PhoneTop__mainnav__container__col__a__chi">查看居民名冊</div>
                </a>
                <a class="PhoneTop__mainnav__container__col__a" href="resident/resident.html">
                    <div class="PhoneTop__mainnav__container__col__a__eng">BCCTB</div>
                    <div class="PhoneTop__mainnav__container__col__a__chi">Buddy市觀光局</div>
                </a>
            </div>
            <div class="PhoneTop__mainnav__container__col__line"></div>
            <div class="PhoneTop__mainnav__container__col">
                <a class="PhoneTop__mainnav__container__col__a" href="#">
                    <div class="PhoneTop__mainnav__container__col__a__eng">ENGLISH</div>
                </a>
                <a class="PhoneTop__mainnav__container__col__a" href="map.html" target="_blank">
                    <div class="PhoneTop__mainnav__container__col__a__eng">日本語</div>
                </a>
            </div>
        </div>
    </div>
    </div>
    <!--Top-->
    <div class="Top">
        <div class="Top__container">
            <div class="Top__nav_container__menu">
                <div class="Top__nav" id="nav">
                    <ul class="Top__nav__list">
                        <li class="Top__nav_col">
                            <div class="Top__nav_title">
                                <div class="Top__nav_col__burger__icon">
                                    <div class="bar1"></div>
                                    <div class="bar2"></div>
                                    <div class="bar3"></div>
                                </div>
                                MENU
                            </div>
                            <div class="Top__nav_title_under">
                                <div class="Top__nav_subtitle">
                                    <a href="../">
                                        <i aria-hidden="true" class="ion-android-arrow-dropdown"></i>
                                        回到主頁
                                    </a>
                                </div>
                                <div class="Top__nav_subtitle">
                                    <a href="https://buddycityinfo.sgngs.com/map.html" target=_blank>
                                        <i aria-hidden="true" class="ion-android-arrow-dropdown"></i>
                                        網上地圖
                                    </a>
                                </div>
                                <div class="Top__nav_subtitle">
                                    <a href="#">
                                        <i aria-hidden="true" class="ion-android-arrow-dropdown"></i>城市建築物名冊</a></div>
                                <div class="Top__nav_subtitle">
                                    <a href="../resident/">
                                        <i aria-hidden="true" class="ion-android-arrow-dropdown"></i>
                                        居民名冊
                                    </a>
                                </div>
                                <div class="Top__nav_subtitle">
                                    <a href="https://buddycityinfo.sgngs.com/page/bcctb-about-us.html">
                                        <i aria-hidden="true" class="ion-android-arrow-dropdown"></i>
                                        Buddy市觀光局
                                    </a>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="Top__logo">
                <a href="index.html"><img src="../image/logo.png" /></a>
            </div>
            <!--Top right option-->
            <div class="Top__nav_container__language">
                <div class="Top__nav" id="nav">
                    <ul class="Top__nav__list"></ul>
                    <li class="Top__nav_col">
                        <div class="Top__nav_title">Language</div>
                        <div class="Top__nav_title_under">
                            <div class="Top__nav_subtitle"><a href=".eng/">English</a></div>
                            <div class="Top__nav_subtitle"><a href=".jp/">日本語</a></div>
                        </div>
                    </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!--main-->
    <div class="main__banner"></div>
    <div class="main">
        <!-- main_content -->
        <div class="main__content">
            <div class="BuildingList">
                <div class="BuildingList__title__content">
                    <div class="BuildingList__title">
                        城市建築物名冊
                    </div>
                    <div class="BuildingList__text">
                        BUDDY 市內所有建築物，全部呈現在您眼前。
                    </div>
                </div>
                <div id="district__image">
                </div>
                <div id="buildingPopUpLayer">
                    <div class="buildingPopUpLayer__container">
                        <div class="buildingPopUpLayer_closeLayer" onclick="closeLayer(this)"></div>
                        <div class="buildingPopUpLayer__container__main">
                            <div id="districtData">
                                <div id="data_district_title" class="data__title"></div>
                                <div id="building" class="districtData"></div>
                            </div>
                            <div id="buildingData">
                                <div id="data_building_title" class="data__title"></div>
                                <table class="data__table">
                                    <tr>
                                        <td class="data__table__datatitle">
                                            建築物名稱
                                        </td>
                                        <td id="data_buildingName" class="data__table__datainfo">

                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="data__table__datatitle">
                                            區域
                                        </td>
                                        <td id="data_district" class="data__table__datainfo">

                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="data__table__datatitle">
                                            地址
                                        </td>
                                        <td class="data__table__datainfo" id="data_adress">

                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="data__table__datatitle">
                                            用途
                                        </td>
                                        <td class="data__table__datainfo" id="data_Utilization">

                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="data__table__datatitle">
                                            是否有內裝？
                                        </td>
                                        <td class="data__table__datainfo" id="data_inside">

                                        </td>
                                    </tr>
                                </table>
                                <!--map-->
                                <div id="address_map" class="address__map">
                                    <div class="address__map__title">MAP</div>
                                    <iframe id="data_address_map" class="address__map__iframe" width="100%"
                                        height="440px"></iframe>
                                    ><a class="address__map__link" id="data_address_link" target="blank">網上地圖</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--footer-->
    <div class="footer">
        <div class="footer__content">
            <div class="footer__content__weblogo">
                <img class="footer__content__weblogo__image" src="../image/logo.png">
            </div>
            <div class="footer__content__box">
                <div class="footer__content__text__adress">
                    BUDDY CITY旅遊局<br> Buddy City大阪區本町通2號2樓2D01室
                </div>
                <div class="footer__content__links">
                    <a class="footer__content__box__btn"
                        href="https://buddycityinfo.sgngs.com/page/bcctb-about-us.html">
                        <div class="footer__content__box__btn__text">BUDDY CITY旅遊局紹介</div>
                    </a>
                    <a class="footer__content__box__btn" href="https://buddycityinfo.sgngs.com/page/tnc.html">
                        <div class="footer__content__box__btn__text">服務條款</div>
                    </a>
                    <a class="footer__content__box__btn" href="https://buddycityinfo.sgngs.com/map.html">
                        <div class="footer__content__box__btn__text">Dynmap</div>
                    </a>
                </div>
                <div class="footer__content__box__copyright">
                    ©BUDDY CITY CONVENTION & TOURISM BUREAU
                </div>
            </div>
        </div>
    </div>
</body>
<script type="text/javascript" src="../js/jquery.js"></script>
<!--トップ上げる-->
<script type="text/javascript" src="../js/totop.min.js"></script>
<!--ゆっくり上げる-->
<script type="text/javascript" src="../js/jquery.easing.1.3.js"></script>
<script>
    function menu_burger(x) {
        x.classList.toggle("change");
        if (PhoneTop__mainnav__container.style.display === "flex") {
            PhoneTop__mainnav__container.style.display = "none";
        } else {
            PhoneTop__mainnav__container.style.display = "flex";
        }
    }
    function closeLayer(x) {
        x.classList.toggle("change");
        buildingPopUpLayer.style.display = "none";
    }
</script>

<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/7.3.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.1.0/firebase-database.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/7.3.0/firebase-analytics.js"></script>
<script>

    // Your web app's Firebase configuration
    var firebaseConfig = {
        apiKey: "AIzaSyD8rlfI1ia02uVCyn4HigEgKnqSVppm96c",
        authDomain: "buddy-city-6644d.firebaseapp.com",
        databaseURL: "https://buddy-city-6644d.firebaseio.com",
        projectId: "buddy-city-6644d",
        storageBucket: "buddy-city-6644d.appspot.com",
        messagingSenderId: "602566457456",
        appId: "1:602566457456:web:b7339ee8dc4121e7771cb5",
        measurementId: "G-21NGJNE2VH"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();
    //Get Data
    //Get Data
    var userDataRef = firebase.database().ref("building");
    userDataRef.once("value").then(
        res => {
            res.forEach((districtSh, buildingIndex) => {
                let districtInfo = districtSh.child("0").val();
                console.log(districtInfo.district_chi, districtSh.key);
                var districtTitleString =
                    `<div class="district__image__box" background-image: url("paper.gif"); onClick="chooseDistrict('${districtSh.key}')">
                    <div class="district__image__box__content">
                        <img class="district__image__box__image" src="image/${districtSh.key}.jpg">
                        <div class="district__image__box__toptext">查看更多</div>
                        <div class="district__image__box__shadow"></div>
                        <div class="district__image__box__text">${districtInfo.district_chi}</div>
                    </div>
                    </div>`;
                $('#district__image').append(districtTitleString);
            })
        },
        rej => {
            console.log(rej);
        }
    );

    function chooseDistrict(districtId) {
        buildingPopUpLayer.style.display = "flex";
        buildingData.style.display = "none";
        districtData.style.display = "block";
        console.log(districtId);
        $("#building").empty();
        var userDataRef = firebase.database().ref("/building/" + districtId);
        userDataRef.once("value").then(
            res => {
                res.forEach((buildingIndex, index) => {
                    let cityInfo = buildingIndex.val();
                    console.log(cityInfo.name_chi);
                    var buildingString =
                        `<div target="_blank" class="district__building" id="districtId=${districtId}&buildingId=${buildingIndex}" onClick="chooseBuilding('${districtId}', ${buildingIndex.key})">` +
                        `<div class="district__building__name">${cityInfo.name_chi}</div>
                        </a>`;
                    $('#building').append(buildingString);
                });
                let districtInfo = res.child("0").val();
                $('#data_district_title').html(districtInfo.district_chi);
                console.log(districtInfo.district_chi);
            },
            rej => {
                console.log(rej);
            }
        );
    }

    function chooseBuilding(districtId, buildingId) {
        buildingPopUpLayer.style.display = "flex";
        buildingData.style.display = "block";
        districtData.style.display = "none";
        console.log(districtId + " " + buildingId);
        var userDataRef = firebase.database().ref("/building/" + districtId + "/" + buildingId);
        userDataRef.once("value").then(
            res => {
                let buildingInfo = res.val();
                $('.data_link_eng').attr("href", `../eng/building_list/building.html?districtId=${districtId}&buildingId=${buildingId}`);
                $('.data_link_jp').attr("href", `../jp/building_list/building.html?districtId=${districtId}&buildingId=${buildingId}`);
                $('#data_building_ahref').html(buildingInfo.name_chi);
                $('#data_building_title').html(buildingInfo.name_chi);
                $('#data_buildingName').html(buildingInfo.name_chi);
                $('#data_district').html(buildingInfo.district_chi);
                $('#data_adress').html(buildingInfo.adress_chi);
                $('#data_Utilization').html(buildingInfo.用途);
                $('#data_inside').html(buildingInfo.內裝);
                $('#data_address_map').attr("src", `https://buddycityinfo.sgngs.com/map.html?worldname=world&mapname=flat&zoom=6&x=${buildingInfo.x}&y=${buildingInfo.y}&z=${buildingInfo.z}`);
                $('#data_address_link').attr("href", `https://buddycityinfo.sgngs.com/map.html?worldname=world&mapname=flat&zoom=6&x=${buildingInfo.x}&y=${buildingInfo.y}&z=${buildingInfo.z}`);
                document.title = `${buildingInfo.name_chi}` + `丨城市建築物名冊丨Buddy-INFO Buddy市指南)`;
            },
            rej => {
                console.log(rej);
            }
        );

    }

</script>

</html>